var ComponentsDateTimePickers = function () {

    var handleDatePickers = function () {

        if (jQuery().datepicker) {
            $('.date-picker').datepicker({
                rtl: App.isRTL(),
                orientation: "left",
                autoclose: true
            });
			
            //$('body').removeClass("modal-open"); // fix bug when inline picker is used in modal
        }

        /* Workaround to restrict daterange past date select: http://stackoverflow.com/questions/11933173/how-to-restrict-the-selectable-date-ranges-in-bootstrap-datepicker */
    
        // Workaround to fix datepicker position on window scroll
        $( document ).scroll(function(){
            $('#form_modal2 .date-picker').datepicker('place'); //#modal is the id of the modal
        });
    }

    var handleTimePickers = function () {

        if (jQuery().timepicker) {
            $('.timepicker-default').timepicker({
                autoclose: true,
                showSeconds: true,
                minuteStep: 1
            });

            $('.timepicker-no-seconds').timepicker({
                autoclose: true,
                minuteStep: 5,
                defaultTime: false
            });

            $('.timepicker-24').timepicker({
                autoclose: true,
                minuteStep: 5,
                showSeconds: false,
                showMeridian: false
            });

            // handle input group button click
            $('.timepicker').parent('.input-group').on('click', '.input-group-btn', function(e){
                e.preventDefault();
                $(this).parent('.input-group').find('.timepicker').timepicker('showWidget');
            });

            // Workaround to fix timepicker position on window scroll
            $( document ).scroll(function(){
                $('#form_modal4 .timepicker-default, #form_modal4 .timepicker-no-seconds, #form_modal4 .timepicker-24').timepicker('place'); //#modal is the id of the modal
            });
        }
    }

    var handleDateRangePickers = function () {
        if (!jQuery().daterangepicker) {
            return;
        }

        $('#defaultrange').daterangepicker({
                opens: (App.isRTL() ? 'left' : 'right'),
                format: 'DD/MM/YYYY',
                separator: ' a ',
                startDate: moment().subtract('days', 29),
                endDate: moment(),
                ranges: {
                    'Hoy': [moment(), moment()],
                    'Ayer': [moment().subtract('days', 1), moment().subtract('days', 1)],
                    'Últimos 7 días': [moment().subtract('days', 6), moment()],
                    'Últimos 30 días': [moment().subtract('days', 29), moment()],
                    'Este mes': [moment().startOf('month'), moment().endOf('month')],
                    'Mes anterior': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
                },
                minDate: '01/01/2012',
                maxDate: '31/12/2018',
            },
            function (start, end) {
                $('#defaultrange input').val(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            }
        );        

        $('#defaultrange_modal').daterangepicker({
                opens: (App.isRTL() ? 'left' : 'right'),
                format: 'DD/MM/YYYY',
                separator: ' to ',
                startDate: moment().subtract('days', 29),
                endDate: moment(),
                minDate: '01/01/2012',
                maxDate: '12/31/2018',
            },
            function (start, end) {
                $('#defaultrange_modal input').val(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            }
        );  

        // this is very important fix when daterangepicker is used in modal. in modal when daterange picker is opened and mouse clicked anywhere bootstrap modal removes the modal-open class from the body element.
        // so the below code will fix this issue.
        $('#defaultrange_modal').on('click', function(){
            if ($('#daterangepicker_modal').is(":visible") && $('body').hasClass("modal-open") == false) {
                $('body').addClass("modal-open");
            }
        });
		
		
		/* end reportrange */
		
		$('#reportrange').on('apply.daterangepicker', function(ev, picker) {
			//do something, like clearing an input
			$(this).val(picker.startDate.format('DD/MM/YYYY') + ' - ' + picker.endDate.format('DD/MM/YYYY'));
			$('form#filtro').submit();
		});
	
	
		$('#reportrange').on('cancel.daterangepicker', function(ev, picker) {
			$(this).val('');
			$('form#filtro').submit();
		});
		
		$('#reportrange').daterangepicker({
			showDropdowns: true,
			ranges: {
				'Hoy': [moment(), moment()],
				'Ayer': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
				'Esta semana': [moment().startOf('week'), moment().endOf('week')],
				'Última semana': [moment().subtract(6, 'days'), moment()],
				'Últimas 2 semanas': [moment().subtract(13, 'days'), moment()],
				'Este mes': [moment().startOf('month'), moment().endOf('month')],
				'Mes anterior': [moment().subtract(1, 'month').startOf('month'),
					moment().subtract(1, 'month').endOf('month')]
			},
			autoUpdateInput: false,
			applyClass: 'btn-sm btn-primary',
			cancelClass: 'btn-sm btn-default',
			locale: {
				format: 'DD/MM/YYYY',
				applyLabel: 'Aplicar',
				cancelLabel: 'Limpiar',
				fromLabel: 'Desde',
				toLabel: 'Hasta',
				customRangeLabel: 'Seleccionar rango',  
				daysOfWeek: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
				monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
					'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre',
					'Diciembre'],
				firstDay: 1
			}
		},function(start, end) {
			console.log(start);
			console.log(end);
			  //$("#f_datefrom").val(start.format('YYYY/MM/DD'));
			 //$("#f_dateto").val(end.format('YYYY/MM/DD'));
		});
		
		$('#reportrange').on("change", function(){
			console.log("changes");
		});
	
		//Set the initial state of the picker label
		$('#reportrange span').html('Desde: '+ moment().subtract('days', 29).format('DD/MM/YYYY') + ' Hasta:' +  moment().format('DD/MM/YYYY'));
		
		/* end reportrange */
		
		
		/* rangebiblioteca */
		
		
		$('#rangebiblioteca').daterangepicker({
			showDropdowns: true,
			ranges: {
				'Hoy': [moment(), moment()],
				'Ayer': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
				'Esta semana': [moment().startOf('week'), moment().endOf('week')],
				'Última semana': [moment().subtract(6, 'days'), moment()],
				'Últimas 2 semanas': [moment().subtract(13, 'days'), moment()],
				'Este mes': [moment().startOf('month'), moment().endOf('month')],
				'Mes anterior': [moment().subtract(1, 'month').startOf('month'),
					moment().subtract(1, 'month').endOf('month')]
			},
			 autoUpdateInput: false,
			applyClass: 'btn-sm btn-primary',
			cancelClass: 'btn-sm btn-default',
			locale: {
				format: 'DD/MM/YYYY',
				applyLabel: 'Aplicar',
				cancelLabel: 'Limpiar',
				fromLabel: 'Desde',
				toLabel: 'Hasta',
				customRangeLabel: 'Seleccionar rango',  
				daysOfWeek: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
				monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
					'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre',
					'Diciembre'],
				firstDay: 1
			}
		},function(start, end) {
			console.log(start);
			console.log(end);
				  //$("#f_datefrom").val(start.format('YYYY/MM/DD'));
				 //$("#f_dateto").val(end.format('YYYY/MM/DD'));
			});
			
	$('#rangebiblioteca').on("change", function(){
        console.log("changes");
    });

        //Set the initial state of the picker label
        $('#rangebiblioteca span').html('Desde: '+ moment().subtract('days', 29).format('DD/MM/YYYY') + ' Hasta:' +  moment().format('DD/MM/YYYY'));
		
		// End rangebiblioteca
		
		// start filterrange
		
			
		/* rangebiblioteca */
		
		
		$('#filterrange').daterangepicker({
			showDropdowns: true,
			ranges: {
				'Hoy': [moment(), moment()],
				'Ayer': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
				'Esta semana': [moment().startOf('week'), moment().endOf('week')],
				'Última semana': [moment().subtract(6, 'days'), moment()],
				'Últimas 2 semanas': [moment().subtract(13, 'days'), moment()],
				'Este mes': [moment().startOf('month'), moment().endOf('month')],
				'Mes anterior': [moment().subtract(1, 'month').startOf('month'),
					moment().subtract(1, 'month').endOf('month')]
			},
			 autoUpdateInput: false,
			applyClass: 'btn-sm btn-primary',
			cancelClass: 'btn-sm btn-default',
			locale: {
				format: 'DD-MM-YYYY',
				applyLabel: 'Aplicar',
				cancelLabel: 'Limpiar',
				fromLabel: 'Desde',
				toLabel: 'Hasta',
				customRangeLabel: 'Seleccionar rango',  
				daysOfWeek: ['Do', 'Lu', 'Ma', 'Mi', 'Ju', 'Vi', 'Sa'],
				monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
					'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre',
					'Diciembre'],
				firstDay: 1
			}
		},function(start, end) {
			console.log(start);
			console.log(end);
				  //$("#f_datefrom").val(start.format('YYYY/MM/DD'));
				 //$("#f_dateto").val(end.format('YYYY/MM/DD'));
			});
			
	$('#filterrange').on("change", function(){
        console.log("changes");
    });

        //Set the initial state of the picker label
        $('#filterrange span').html('Desde: '+ moment().subtract('days', 29).format('DD-MM-YYYY') + ' Hasta:' +  moment().format('DD-MM-YYYY'));
		
		// end filterrange
    }

    var handleDatetimePicker = function () {

        if (!jQuery().datetimepicker) {
            return;
        }

        $(".form_datetime").datetimepicker({
            autoclose: true,
            isRTL: App.isRTL(),
            format: "dd MM yyyy - hh:ii",
            pickerPosition: (App.isRTL() ? "bottom-right" : "bottom-left")
        });

        $(".form_advance_datetime").datetimepicker({
            isRTL: App.isRTL(),
            format: "dd MM yyyy - hh:ii",
            autoclose: true,
            todayBtn: true,
            startDate: "2013-02-14 10:00",
            pickerPosition: (App.isRTL() ? "bottom-right" : "bottom-left"),
            minuteStep: 10
        });

        $(".form_meridian_datetime").datetimepicker({
            isRTL: App.isRTL(),
            format: "dd MM yyyy - HH:ii P",
            showMeridian: true,
            autoclose: true,
            pickerPosition: (App.isRTL() ? "bottom-right" : "bottom-left"),
            todayBtn: true
        });

        $('body').removeClass("modal-open"); // fix bug when inline picker is used in modal

        // Workaround to fix datetimepicker position on window scroll
        $( document ).scroll(function(){
            $('#form_modal1 .form_datetime, #form_modal1 .form_advance_datetime, #form_modal1 .form_meridian_datetime').datetimepicker('place'); //#modal is the id of the modal
        });
    }

    var handleClockfaceTimePickers = function () {

        if (!jQuery().clockface) {
            return;
        }

        $('.clockface_1').clockface();

        $('#clockface_2').clockface({
            format: 'HH:mm',
            trigger: 'manual'
        });

        $('#clockface_2_toggle').click(function (e) {
            e.stopPropagation();
            $('#clockface_2').clockface('toggle');
        });

        $('#clockface_2_modal').clockface({
            format: 'HH:mm',
            trigger: 'manual'
        });

        $('#clockface_2_modal_toggle').click(function (e) {
            e.stopPropagation();
            $('#clockface_2_modal').clockface('toggle');
        });

        $('.clockface_3').clockface({
            format: 'H:mm'
        }).clockface('show', '14:30');

        // Workaround to fix clockface position on window scroll
        $( document ).scroll(function(){
            $('#form_modal5 .clockface_1, #form_modal5 #clockface_2_modal').clockface('place'); //#modal is the id of the modal
        });
    }

    return {
        //main function to initiate the module
        init: function () {
            handleDatePickers();
            handleTimePickers();
            handleDatetimePicker();
            handleDateRangePickers();
            handleClockfaceTimePickers();
        }
    };

}();

if (App.isAngularJsApp() === false) { 
    jQuery(document).ready(function() {    
        ComponentsDateTimePickers.init(); 
    });
}